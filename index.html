<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<title>genetic-js</title>
	<script src="lib/genetic.js"></script>

	<script>
	
	var ga = Genetic.create();
	
	ga.seed = function() {

		function randomString(len) {
			var text = "";
			var charset = "abcdefghijklmnopqrstuvwxyz0123456789";
			for(var i=0;i<len;i++)
				text += charset.charAt(Math.floor(Math.random() * charset.length));
			
			return text;
		}
		
		// create random strings that are equal in length to targetString
		return randomString(this.userData["targetString"].length);
	};
	
	ga.optimize = Genetic.Optimize.Maximize;
	ga.select1 = Genetic.Select1.Tournament;
	ga.select2 = Genetic.Select2.Tournament;
	
	ga.mutate = function(entity) {
		
		function replaceAt(str, index, character) {
		    return str.substr(0, index) + character + str.substr(index+character.length);
		}
		
		// chromosomal drift
		var i = Math.floor(Math.random()*entity.length)		
		return replaceAt(entity, i, String.fromCharCode(entity.charCodeAt(i) + (Math.floor(Math.random()*2) ? 1 : -1)));
	};
		
	ga.fitness = function(entity) {
		var fitness = 0;
		
		var i;
		for (i=0;i<entity.length;++i) {
			// increase fitness for each character that matches
			if (entity[i] == this.userData.targetString[i])
				fitness += 1;
			
			// award fractions of a point if the ordinal value of characters is close
			fitness += (127-Math.abs(entity.charCodeAt(i) - this.userData["targetString"].charCodeAt(i)))/50;
		}

		return fitness;
	};
	
	var config = {
		"iterations": 4000
		, "size": 250
		, "mutation": 0.3
	};
	
	var userData = {
		"targetString": "This is a test to see that it works"
	};
	
	ga.evolve(config, userData);
	
	</script>
	
</head>
<body>
	
	
</body>
</html>